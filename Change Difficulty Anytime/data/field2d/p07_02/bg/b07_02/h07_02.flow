import( "h07_02.bf" );
import( "h07_02.msg" );

// Procedure Index: 18
void HIT_SCRIPT_255_hook()
{
    int var26;
    MSG_WND_DSP();
    MSG( CHECK_SAVE_POINT );
    
    if ( ( FUNCTION_0033() != 5 ) || GET_DAY( 1, 31 ) )
    {
        FUNCTION_0006( 2 );
    }

    FUNCTION_002C( 14, 2 );
    var26 = SEL( SAVE_SEL );
    MSG_WND_CLS();
    
    if ( var26 == 0 )
    {
        FADE( 1, 10 );
        SAVE_MENU();
        FUNCTION_000D( 0 );
    }
	if ( var26 == 1 )
    {
		ChangeDifficulty();
    }
    else if ( var26 == 2 )
    {
        
        if ( BIT_CHK( 3592 ) )
        {
            MSG_WND_DSP();
            MSG( STOP_INTO_MYROOM_2 );
            MSG_WND_CLS();
            return;
        }
        else if ( GET_DAY( 4, 7 ) || !BIT_CHK( 3086 ) )
        {
            MSG_WND_DSP();
            MSG( GOINTO_MYROOM_SAVE_OK );
            FUNCTION_002C( 14, 1 );
            
            if ( SEL( INTO_ROOM_SEL ) != 0 )
            {
                MSG_WND_CLS();
                return;
            }

            MSG_WND_CLS();
        }

        
        if ( !BIT_CHK( 3045 ) && ( CHK_DAYS_STARTEND( 4, 7, 4, 21 ) || CHK_DAYS_STARTEND( 3, 1, 3, 5 ) ) )
        {
            BIT_ON( 2562 );
            MSG_WND_DSP();
            
            if ( CHK_DAYS_STARTEND( 4, 7, 4, 21 ) )
            {
                MSG( GOINTO_MYROOM_SLEEP );
            }
            else if ( CHK_DAYS_STARTEND( 3, 1, 3, 5 ) )
            {
                
                if ( BIT_CHK( 2958 ) )
                {
                    MSG( GOINTO_MYROOM_LASTWEEK );
                }
                else 
                {
                    MSG( GOINTO_MYROOM_SLEEP );
                }

            }

            MSG_WND_CLS();
        }

        call_midnight_myroom();
        return;
    }

}

void ChangeDifficulty()
{
	
int CurrentDifficulty;
int HideVar = 0;
int var17;

if ( BIT_CHK(4891) ) // Beginner
{
	HideVar = ( HideVar + 1 );
	CurrentDifficulty = 1;
}
else if ( BIT_CHK(4881) ) // Easy
{
	HideVar = ( HideVar + 2 );
	CurrentDifficulty = 2;
}
else if ( BIT_CHK(4889) ) // Hard
{
	HideVar = ( HideVar + 8 );
	CurrentDifficulty = 4;
}
else if ( BIT_CHK(4890) ) // Maniac
{
	HideVar = ( HideVar + 16 );
	CurrentDifficulty = 5;
}
else // Normal
{
	HideVar = ( HideVar + 4 );
	CurrentDifficulty = 3;
}

MSG_WND_DSP();
MSG( QUESTION );
FUNCTION_002C(14, 6);
FUNCTION_0006(HideVar);
var17 = SEL(CHANGE_DIFFICULTY);

if ( var17 == 0 ) // Beginner
{
	if ( CurrentDifficulty == 1 )
	{
		BIT_OFF(4891);
	}
	else if ( CurrentDifficulty == 2 )
	{
		BIT_OFF(4881);
	}
	else if ( CurrentDifficulty == 3 )
	{
	}
	else if ( CurrentDifficulty == 4 )
	{
		BIT_OFF(4889);
	}
	else if ( CurrentDifficulty == 5 )
	{
		BIT_OFF(4890);
	}
	BIT_ON(4891);
	MSG(CHANGED_BEGINNER);
	MSG_WND_CLS();
}

if ( var17 == 1 ) // Easy
{
	if ( CurrentDifficulty == 1 )
	{
		BIT_OFF(4891);
	}
	else if ( CurrentDifficulty == 2 )
	{
		BIT_OFF(4881);
	}
	else if ( CurrentDifficulty == 3 )
	{
	}
	else if ( CurrentDifficulty == 4 )
	{
		BIT_OFF(4889);
	}
	else if ( CurrentDifficulty == 5 )
	{
		BIT_OFF(4890);
	}
	BIT_ON(4891);
	MSG(CHANGED_EASY);
	MSG_WND_CLS();
}

if ( var17 == 3 ) // Hard
{
	if ( CurrentDifficulty == 1 )
	{
		BIT_OFF(4891);
	}
	else if ( CurrentDifficulty == 2 )
	{
		BIT_OFF(4881);
	}
	else if ( CurrentDifficulty == 3 )
	{
	}
	else if ( CurrentDifficulty == 4 )
	{
		BIT_OFF(4889);
	}
	else if ( CurrentDifficulty == 5 )
	{
		BIT_OFF(4890);
	}
	BIT_ON(4889);
	MSG(CHANGED_HARD);
	MSG_WND_CLS();
}

if ( var17 == 4 ) // Maniac
{
	if ( CurrentDifficulty == 1 )
	{
		BIT_OFF(4891);
	}
	else if ( CurrentDifficulty == 2 )
	{
		BIT_OFF(4881);
	}
	else if ( CurrentDifficulty == 3 )
	{
	}
	else if ( CurrentDifficulty == 4 )
	{
		BIT_OFF(4889);
	}
	else if ( CurrentDifficulty == 5 )
	{
		BIT_OFF(4890);
	}
	BIT_ON(4890);
	MSG(CHANGED_MANIAC);
	MSG_WND_CLS();
}

if ( var17 == 2 ) // Normal
{
	if ( CurrentDifficulty == 1 )
	{
		BIT_OFF(4891);
	}
	else if ( CurrentDifficulty == 2 )
	{
		BIT_OFF(4881);
	}
	else if ( CurrentDifficulty == 3 )
	{
	}
	else if ( CurrentDifficulty == 4 )
	{
		BIT_OFF(4889);
	}
	else if ( CurrentDifficulty == 5 )
	{
		BIT_OFF(4890);
	}
	MSG(CHANGED_NORMAL);
	MSG_WND_CLS();
}

if ( var17 == 5 ) // Cancel
{
	return;
	MSG_WND_CLS();
}
}
